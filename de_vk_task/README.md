# Практическог задание на стажировку в ВК


### Описание
Репозиторий предназначен для участия в отборе на стажировку в качестве дата-инженера в ВК.


### Структура репозитория

В папке `data` расположен пример csv-файл`а для проведения расчёта.

Внутри `src` расположены две папки:
|-- `/src`
|     |-- `/dags/de_vk_task_dag.py` dag для запуска в Airflow;
|     |-- `/scripts` Python-скрипты, выполняющие задание:
|     |------ `/de_vk_task.py` Минимальный функционал.
|     |------ `/de_vk_task_spark.py` Рекомендуемый функционал.

Папка `output` служит для записи по умолчанию csv-файла c итогом расчёта. 


### Запуск расчёта

##### Запуск минимального функционала

Находясь в корневой папке проекта выполнить команду
python3 src/scripts/de_vk_task.py <дата расчёта в виде YYYY-mm-dd> <путь до входного csv-файла> <путь до папки записи итога расчёта>

Здесь параметры <путь до входного csv-файла> и <путь до папки записи итога расчёта> возможно опустить, в этом случае будут использованы `data` и `output` (см. выше).

!!! ВНИМАНИЕ !!! Порядок параметров важен, то есть вторым параметром всегда должен быть <путь до входного csv-файла>. То есть если нужно задать <путь до папки записи итога расчёта>, то и <путь до входного csv-файла> так же необходимо указывать, даже если используется входной csv-файл по-умочланию.

Пример:
python3 src/scripts/de_vk_task.py 2024-01-21


##### Запуск рекомендуемого функционала

1. Задать в Airflow переменные

    * process_date дата расчёта;

    * path_csv_file путь до входного csv-файла>;

    * path_result путь до папки записи итога расчёта.

2. Задать внутри dag `/src/dags/de_vk_task_dag.py` путь, куда будет помещён скрипт расчёта `/src/scripts/de_vk_task_spark.py` в Airflow:
Строчка 50
   application = '/<указать путь до скрипта расчёта>/de_vk_task_spark.py',

3. Загрузить скрипт расчёта `/src/scripts/de_vk_task_spark.py` в Airflow по указанному на шаге 2 пути.

4. Загрузить dag `/src/dags/de_vk_task_dag.py` в Airflow.

5. Запустить dag `/src/dags/de_vk_task_dag.py` в Airflow.


### Замечание


